---
layout: post
title:  "ToCSV Object Extension"
date:   2020-04-07 16:14:04 -0300
categories: c# extension
---

this is a simple extension that generates a CSV string out of an object.

### usage example

{% highlight c# %}
//  create some objects
var dean = new Person 
{ 
    Id = 1, 
    Name = "Dean", 
    BirthDate = new DateTime(1979, 01, 24) 
};
var sam = new Person 
{ 
    Id = 1, 
    Name = "Sam", 
    BirthDate = new DateTime(1983, 05, 02) 
};
var brothers = new List<Person> { dean, sam };

// generate CSVs
String simpleObjectCSV = dean.ToCSV();
String simpleListCSV = brothers.ToCSV();

// generate formatted CSV
String brothersCSV = brothers.ToCSV(
  separator: ";", 
  formattedProperties: {
    Id: "0.0"
  },
  datesFormat: "dd/MM/yyyy"
);

/*
    brothersCSV value:
    
    Id;Name;BirthDate
    1.0;Dean;24/01/1979
    2.0;Sam;02/05/1983
*/
{% endhighlight %}


### formatting options
type      | option               | description                                                                 
--------- | -------------------- | -----------------------------------------------------------------------------
`object`  | formattedProperties  | specific formats for specific properties - higher priority over other options
`String`  | separator            | separator character between cells
`bool`    | suppressHeader       | hide header or not
`object`  | translatedColumns    | replace column header names)
`List`    | ignoredProperties    | remove columns)
`String`  | datesFormat          | format all dates this way)
`bool`    | surroundWithQuotes   | surround all cells with quotes)
`List`    | surroundedWithQuotes | surround specific cells with quotes)

#### code at [Github](https://github.com/kelvindules/tocsv.git)
