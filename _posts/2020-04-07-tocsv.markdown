---
layout: post
title:  "tocsv object extension"
date:   2020-04-07 16:14:04 -0300
categories: c# extension csv
author: kelvin dules
---

this is a simple extension that generates a CSV string out of an object.

### usage example

create some objects
{% highlight c# %}
var dean = new Person 
{ 
    Id = 1, 
    Name = "Dean", 
    Birthdate = new DateTime(1979, 01, 24) 
};
var sam = new Person 
{ 
    Id = 1, 
    Name = "Sam", 
    Birthdate = new DateTime(1983, 05, 02) 
};
{% endhighlight %}

call extension
{% highlight c# %}
var basic = dean.ToCSV();

var list = new List<Person> { dean, sam }
  .ToCSV(separator: ";", surroundByQuotes: true, datesFormat: "dd/MM/yyyy");
{% endhighlight %}

what you'll get by calling the basic .ToCSV()
{% highlight c# %}
/*
  basic output

  Id,Name,Birthdate
  1,Dean,1979-01-24
*/
{% endhighlight %}

a formatted example making use of the extension options on a list
{% highlight c# %}
/*
  list output
  
  "Id";"Name";"Birthdate"
  "1";"Dean";"24/01/1979"
  "2";"Sam";"02/05/1983"
*/
{% endhighlight %}

### formatting options
type      | option               | description                                                                 
--------- | -------------------- | -----------------------------------------------------------------------------
`object`  | formattedProperties  | specific formats for specific properties - higher priority over other options
`String`  | separator            | separator character between cells
`bool`    | suppressHeader       | hide header or not
`object`  | translatedColumns    | replace column header names)
`List`    | ignoredProperties    | remove columns)
`String`  | datesFormat          | format all dates this way)
`bool`    | surroundWithQuotes   | surround all cells with quotes)
`List`    | surroundedWithQuotes | surround specific cells with quotes)

#### code at [Github](https://github.com/kelvindules/tocsv.git)
